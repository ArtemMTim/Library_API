# API для управления библиотекой
##  Описание:
Проект выполняется в рамках выполнения дипломной работы.

В проекте разработано API приложение для управления библиотекой. Приложение позволяет вести БД читателей, авторов книг и книг. Управлять данными этой БД - создавать, изменять,
просматривать и удалять. Также приложение позволяет отслеживать выдачу/возврат книг и информировать читателей о выдаче и сроках возврата с периодическим напоминанием
путём рассылки по электронной почте и в телеграм (при наличии).

В проекте реализовано два приложения:
- "users" - для управления пользователями (создание, редактирование, удаление, авторизация и т.д.);
- "library" - для работы с книгами и авторами (создание, редактирование, удаление, просмотр, выдача и приём от читателей).

Для приложения users:
- реализована модель User;
- реализован сериалайзер с отображением доролнительного поля о читаемых пользователем книг;
- реализована проверка прав доступа - пользователь может просматривать и редактировать только свою страницу с данными;
- реализован CRUD для модели User;
- реализованы фильтрация и сортировка;
- контроллеры CRUD операций покрыты тестами;
- реализована кастомная команда по созданию супер-пользователя - create_super_user;
- реализованы эндпойнты регистрации, авторизации, CRUD операций модели User.

Для приложения library:
- реализованы модели Author, Book;
- реализованы сериалайзеры с дополнительным полем отображения всех книг автора;
- реализована валидация при заполнении БД авторов - проверка уникальности автора в БД, проверка правильности заполнения дат жизни;
- реализована проверка прав доступа к операциям создания, редактирования и удаления авторов и книг - пользователь должен быть сотрудником библиотеки (isstuff);
- реализован CRUD для моделей Author, Book;
- реализованы фильтрация и сортировка;
- реализована пагинация отображения списка авторов и списка книг;
- рализован контроллер выдачи/возврата книг с занесением соответствующих изменений в БД;
- контроллеры CRUD операций и выдачи/возврата книг покрыты тестами;
- реализована отложенная задача по информированию пользователя о получении/возврате книги по электронной почте и по телеграм;
- реализована периодическая задача по информированию пользователя о необходимости возврата книги за 5 дней до срока и в день окончания срока чтения;
- реализованы эндпойнты CRUD операций моделей Author, Book;
- созданы фикстуры для демонстрационного наполнения БД.

Общее для проекта:
- реализован вывод документации;
- реализован CORS;
- критичные переменные "спрятаны" в переменное окружение, создан файл с примером заполнения переменного окружения;
- реализовано логирование событий уровня DEBUG, логи сохраняются в отдельной дирректории;
- для отложенных (celery) и периодических (celery_beat) задач применяется брокер redis;
- приложения проекта (БД, redis, celery, celery_beat, веб_приложение) помещены в контейнеры с использованием docker и docker-compose.



## Установка:
Для запуска без использования контейнеризации:
1. Клонируйте репозиторий:
```
https://github.com/ArtemMTim/Library_API
```
2. Установите зависимости:
```
pip install -r requirements.txt
```
или с использованием Poetry:
```
poetry install
```
2. Установите зависимости:
```
pip install -r requirements.txt
```
3. Запустите команду: 
```
python3 manage.py runserver
```
Теперь к приложению можно обращаться через http://localhost:8000/

4. В браузере по адресу http://localhost:8000/swagger/ можно ознакомиться с описанием API.
## Использование:
Раздел будет дополняться по мере разработки.

Для запуска с использованием контейнеризации:
1. Убедитесь, что Docker установлен на ваш компьютер, или установите из дистрибутива, полученного на сайте https://www.docker.com/.
2. Клонируйте репозиторий:
```
https://github.com/ArtemMTim/Final_project.git
```
3. Для запуска процесса первичного создания контейнеров в терминале перейдите в корневую папку проекта и выполните команду: 
```
docker-compose up -d --build
```
4. После завершения процесса развертывания и запуска приложений в контейнерах docker в терминале появится сообщение:
                                                                                                                           0.0s
 ✔ Service web                            Built                                                                                                                                                54.8s 
 ✔ Service celery-beat                    Built                                                                                                                                                 2.1s 
 ✔ Service celery                         Built                                                                                                                                                 2.1s 
 ✔ Network final_project_default          Created                                                                                                                                               0.0s 
 ✔ Container final_project-redis-1        Created                                                                                                                                               0.6s 
 ✔ Container final_project-db-1           Created                                                                                                                                               0.6s 
 ✔ Container final_project-web-1          Created                                                                                                                                               0.1s 
 ✔ Container final_project-celery-1       Created                                                                                                                                               0.1s 
 ✔ Container final_project-celery-beat-1  Created  

Теперь к приложению можно обращаться через http://localhost:8000/

5. В браузере по адресу http://localhost:8000/swagger/ можно ознакомиться с описанием API.

6. Последующие запуски можно осуществлять командой:
```
docker-compose up
```
7. Остановить работу контейнеров можно командой:
```
docker-compose down
```
## Документация:
Для получения дополнительной информации обратитесь к [документации](docs/README.md).

## Лицензия:

Этот проект лицензирован по [лицензии MIT](LICENSE).
